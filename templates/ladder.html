<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Player Ladder</title>
<link rel="stylesheet" type="text/css" href="view.css" media="all">
<script type="text/javascript" src="form_handler.js"></script>
<script type="text/javascript" src="calendar.js"></script>
</head>
<body id="main_body" >
  <img id="top" src="top.png" alt="">
  <div id="form_container">
    <h1><a>Player Ladder</a></h1>
    <div class="form_description">
      <h2>Live ATTTC Ladder as of {{date_string}}</h2>
      <h2>Season: {{season_string}}</h2>
      <h3><a href="main_menu">Main Menu</a>
        <a href="roster">Roster</a>
        <a href="logout">Logout</a>
      </h3>
    </div>
    <form action="ladder" method="post">
      <label class="description" for="since_date">Show matches since </label>
      <span>
        <input id="since_date_1" name="since_date_1" class="element text" size="2" maxlength="2" value="" type="text"> /
        <label for="since_date_1">MM</label>
      </span>
      <span>
        <input id="since_date_2" name="since_date_2" class="element text" size="2" maxlength="2" value="" type="text"> /
        <label for="since_date_2">DD</label>
      </span>
      <span>
        <input id="since_date_3" name="since_date_3" class="element text" size="4" maxlength="4" value="" type="text">
        <label for="since_date_3">YYYY</label>
      </span>
      <span id="calendar_match">
        <img id="cal_img_match" class="datepicker" src="calendar.gif" alt="Pick a date.">
      </span>
      <script type="text/javascript">
        Calendar.setup({
        inputField         : "since_date_3",
        baseField    : "since_date",
        displayArea  : "calendar_match",
        button                 : "cal_img_match",
        ifFormat         : "%B %e, %Y",
        onSelect         : selectDate
        });
      </script>
      <input type="submit" value="Refresh">
    <form>
    <h2>A-Ladder</h2>
    <h3>Recent matches:</h3>
    {% for am in a_matches %}
      {% block am %}
        <p>
          {{escape(str(am.get('date')))}}:
          {{escape(str(am.get('winner_last_name')))}} <i>def.</i>
          {{escape(str(am.get('loser_last_name')))}} : &nbsp;&nbsp;
          {{escape(str(am.get('score')))}}
          {{escape(str(am.get('notes')))}}
        </p>
      {% end %}
    {% end %}
    <table border="1" style="width:100%">
      <tr>
        <th style="width:7%">Rank</th>
        <th style="width:7%">ID</th>
        <th style="width:51%">Name</th>
        <th style="width:7%">Pts</th>
        <th style="width:7%">LW</th>
        <th style="width:7%">LL</th>
        <th style="width:7%">W</th>
        <th style="width:7%">L</th>
      </tr>
      {% set i = 0 %}
      {% for a in a_ladder %}
        {% set i = i + 1 %}
        {% block a %}
          <tr>
            <td>{{ str(i) }}</td>
            <td>{{ escape(str(a.get('id'))) }}</td>
            <td><a href="profile?player_id={{a.get('id')}}">{{ escape(str(a.get('first_name')) + " " + str(a.get('last_name'))) }}</a></td>
            <td>{{ escape(str(a.get('points'))) }}</td>
            <td>{{ escape(str(a.get('a_wins'))) }}</td>
            <td>{{ escape(str(a.get('a_losses'))) }}</td>
            <td>{{ escape(str(a.get('wins'))) }}</td>
            <td>{{ escape(str(a.get('losses'))) }}</td>
          </tr>
        {% end %}
      {% end %}
    </table>
    <h2>B-Ladder</h2>
    <h3>Recent matches:</h3>
    {% for bm in b_matches %}
      {% block bm %}
        <p>
          {{escape(str(bm.get('date')))}}:
          {{escape(str(bm.get('winner_last_name')))}} <i>def.</i>
          {{escape(str(bm.get('loser_last_name')))}} : &nbsp;&nbsp;
          {{escape(str(bm.get('score')))}}
          {{escape(str(bm.get('notes')))}}
        </p>
      {% end %}
    {% end %}
    <table border="1" style="width:100%">
      <tr>
        <th style="width:7%">Rank</th>
        <th style="width:7%">ID</th>
        <th style="width:51%">Name</th>
        <th style="width:7%">Pts</th>
        <th style="width:7%">LW</th>
        <th style="width:7%">LL</th>
        <th style="width:7%">W</th>
        <th style="width:7%">L</th>
      </tr>
      {% set i = 0 %}
      {% for b in b_ladder %}
        {% set i = i + 1 %}
        {% block b %}
          <tr>
            <td>{{ str(i) }}</td>
            <td>{{ escape(str(b.get('id'))) }}</td>
            <td><a href="profile?player_id={{b.get('id')}}">{{ escape(str(b.get('first_name')) + " " + str(b.get('last_name'))) }}</a></td>
            <td>{{ escape(str(b.get('points'))) }}</td>
            <td>{{ escape(str(b.get('b_wins'))) }}</td>
            <td>{{ escape(str(b.get('b_losses'))) }}</td>
            <td>{{ escape(str(b.get('wins'))) }}</td>
            <td>{{ escape(str(b.get('losses'))) }}</td>
          </tr>
        {% end %}
      {% end %}
    </table>
    <h2>C-Ladder</h2>
    <h3>Recent matches:</h3>
    {% for cm in c_matches %}
      {% block cm %}
        <p>
          {{escape(str(cm.get('date')))}}:
          {{escape(str(cm.get('winner_last_name')))}} <i>def.</i>
          {{escape(str(cm.get('loser_last_name')))}} : &nbsp;&nbsp;
          {{escape(str(cm.get('score')))}}
          {{escape(str(cm.get('notes')))}}
        </p>
      {% end %}
    {% end %}
    <table border="1" style="width:100%">
      <tr>
        <th style="width:7%">Rank</th>
        <th style="width:7%">ID</th>
        <th style="width:51%">Name</th>
        <th style="width:7%">Pts</th>
        <th style="width:7%">LW</th>
        <th style="width:7%">LL</th>
        <th style="width:7%">W</th>
        <th style="width:7%">L</th>
      </tr>
      {% set i = 0 %}
      {% for c in c_ladder %}
        {% set i = i + 1 %}
        {% block c %}
          <tr>
            <td>{{ str(i) }}</td>
            <td>{{ escape(str(c.get('id'))) }}</td>
            <td><a href="profile?player_id={{c.get('id')}}">{{ escape(str(c.get('first_name')) + " " + str(c.get('last_name'))) }}</a></td>
            <td>{{ escape(str(c.get('points'))) }}</td>
            <td>{{ escape(str(c.get('c_wins'))) }}</td>
            <td>{{ escape(str(c.get('c_losses'))) }}</td>
            <td>{{ escape(str(c.get('wins'))) }}</td>
            <td>{{ escape(str(c.get('losses'))) }}</td>
          </tr>
        {% end %}
      {% end %}
    </table>
    <h2>Unranked</h2>
    <table border="1" style="width:100%">
      <tr>
        <th style="width:7%">Rank</th>
        <th style="width:7%">ID</th>
        <th style="width:51%">Name</th>
        <th style="width:7%">Pts</th>
        <th style="width:7%">LW</th>
        <th style="width:7%">LL</th>
        <th style="width:7%">W</th>
        <th style="width:7%">L</th>
      </tr>
      {% set i = 0 %}
      {% for u in u_ladder %}
        {% set i = i + 1 %}
        {% block u %}
          <tr>
            <td>{{ str(i) }}</td>
            <td>{{ escape(str(u.get('id'))) }}</td>
            <td><a href="profile?player_id={{u.get('id')}}">{{ escape(str(u.get('first_name')) + " " + str(u.get('last_name'))) }}</a></td>
            <td>{{ escape(str(u.get('points'))) }}</td>
            <td>0</td>
            <td>0</td>
            <td>{{ escape(str(u.get('wins'))) }}</td>
            <td>{{ escape(str(u.get('losses'))) }}</td>
          </tr>
        {% end %}
      {% end %}
    </table>
    <div id="footer">
      Generated by <a href="http://www.phpform.org">pForm</a>
    </div>
  </div>
  <img id="bottom" src="bottom.png" alt="">
</body>
</html>
